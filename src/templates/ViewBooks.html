{% extends "Index.html" %} 
{% block content %}

    <style>
        .container {
            visibility: hidden;
        }
    </style>
        
    <form action="{% url 'recommendations' %}" method="POST">
        {% csrf_token %}
    <div class="wrapper">
    
    {% for i in books %}
    <div class="container">
        <input type="checkbox" class="checkbox" name="books" value="{{ i.id }}" id="{{ i.id }}"><br>
        <div class="Photo">
        <label for="{{ i.id }}">
        <img class="GalleryItem" src="{{i.image_url}}" alt= "{{ i.title }}">
    </label>
    </div>
    </div>
        <br>
    {% endfor %}
    </div>
    <div class="Bottom-Right_Button">
    <button type="submit" >Submit</button>
</div>
    </form>

    <div class="NextPrevButtons">
    <button onclick="ShowPrev()"> &#8592; </button>
    <button onclick="ShowNext()"> &#8594; </button>
    </div>

    <script>
        let indiceActual = 0;
        let recentAction = "Next"
        const imagenes = document.querySelectorAll("div.container");
        const numImagenes = imagenes.length;

        ShowNext();

        function ShowPrev()
        {
            if (recentAction == "Next")
            {
                indiceActual -= 24;
            }

            for (let i = 0; i < numImagenes; i++)
            {
                imagenes[i].style.visibility = 'hidden';
            }

            let number = 0;
            let PassRow = false;
            let PassSecondRow = false;

            for (let j = indiceActual - 24; j < indiceActual; j++)
            {
                const i = (j + numImagenes) % numImagenes;
                if (i < numImagenes)
                {
                    imagenes[i].style.visibility = 'visible';
                    imagenes[i].style.position = 'fixed';
                    if (number == 8)
                    {
                        number = 0

                        if(!PassRow)
                        {
                            PassRow = true;
                        }

                        else
                        {
                            PassSecondRow = true;
                        }
                    }

                    if (!PassRow)
                    {
                        imagenes[i].style.top = '10px';
                    }

                    if (PassRow && !PassSecondRow)
                    {
                        imagenes[i].style.top = '230px';
                    }

                    if (PassSecondRow)
                    {
                        imagenes[i].style.top = '450px';
                    }

                    imagenes[i].style.left = number * 150 + 'px';

                }

                number ++;
            }

            indiceActual -= 24;
            if (indiceActual < 0)
            {
                indiceActual = numImagenes -24;
            }

            recentAction = "Prev";
        }

        function ShowNext()
        {
            if (recentAction == "Prev")
            {
                indiceActual += 24;
                if (indiceActual >= numImagenes)
                {
                    indiceActual = 0;
                }
            }

            for (let i = 0; i < numImagenes; i++) {
                imagenes[i].style.visibility = 'hidden';
            }

            let number = 0;
            let PassRow = false;
            let PassSecondRow = false;

            for (let j = indiceActual; j < indiceActual +24; j++)
            {
                const i = (j + numImagenes) % numImagenes;
                if (i < numImagenes)
                {
                    imagenes[i].style.visibility = 'visible';
                    imagenes[i].style.position = 'fixed';
                    if (number == 8)
                    {
                        number = 0

                        if(!PassRow)
                        {
                            PassRow = true;
                        }

                        else
                        {
                            PassSecondRow = true;
                        }
                    }

                    if (!PassRow)
                    {
                        imagenes[i].style.top = '10px';
                    }

                    if (PassRow && !PassSecondRow)
                    {
                        imagenes[i].style.top = '230px';
                    }

                    if (PassSecondRow)
                    {
                        imagenes[i].style.top = '450px';
                    }

                    imagenes[i].style.left = number * 150 + 'px';

                }

                number ++;
            }

            indiceActual += 24;
            if (indiceActual >= numImagenes)
            {
                indiceActual = 0;
            }

            recentAction = "Next";
        }
    </script>
    
{% endblock content %}

